/*
 *  jQuery esthetic plugin - v0.0.1
 *  Make your <select> look much more esthetic.
 *  https://github.com/johannestroeger/esthetic
 *
 *  Made by Johannes Troeger
 *  Under WTFPL License
 */
!function(a,b,c){"use strict";function d(b,c){a.extend(this,{options:h,isVisible:!1,$elm:a(b),id:g++,onCreate:function(){},onChange:function(){},onUpdate:function(){}},c),this.select=this.$elm.find("select").detach().get(0),this.List=new e(this.select,this.options),b.innerHTML+='<button class="'+this.options.cssClasses.btn+'">'+"  <span>"+this.List.selected.text+"</span>"+"</button>"+'<div class="'+this.options.cssClasses.list+'"></div>'+'<input type="hidden" class="'+this.options.cssClasses.input+'" name="'+this.select.name+'" value="'+this.select.value+'">',this.$trigger=this.$elm.find("."+this.options.cssClasses.btn),this.$input=this.$elm.find("."+this.options.cssClasses.input),this.$list=this.$elm.find("."+this.options.cssClasses.list),this.eventStream(),this.onCreate(),f.push(this)}function e(a,b){return this.options=b,this.select=a,this.selected=null,this.grpIdx=0,this.parsed=this.parse(),this}var f=[],g=0,h={cssClasses:{btn:"esthetic-trigger",item:"esthetic-item",selected:"esthetic-item-selected",list:"esthetic-list",input:"esthetic-input"},events:["touchstart","mousedown","focusin"],hidden:"hidden"};d.prototype.eventStream=function(){var b=this,c=i(b.options.cssClasses,"."),d=this.options.events;this.$elm.on(d.join(" "),c.join(", "),function(c){c.preventDefault(),c.stopPropagation();var d=a(this);b.isVisible?b.toggle():(b.$list.html(b.List.toHtml()),b.toggle(b.id)),d.hasClass(b.options.cssClasses.item)&&(b.$trigger.text(d.text()),b.$input.attr("value",d.find("button").attr("value")),b.List.updateSelected(d.find("button").attr("value")))})},d.prototype.toggle=function(b){var d=typeof b===c?null:b;a.map(f,function(a){a[a.id===d?"show":"hide"]()})},d.prototype.hide=function(){this.isVisible=!1,this.$elm.find("ul").eq(0).attr("hidden",!0)},d.prototype.show=function(){this.isVisible=!0,this.$elm.find("ul").eq(0).attr("hidden",!1)},e.prototype.updateSelected=function(a){for(var b=0;b<this.parsed.length;b++)this.parsed[b].selected=this.parsed[b].value===a},e.prototype.toHtml=function(){for(var a="",b=this.parsed,c=this.options.cssClasses,d=function(a){return'<li class="'+c.item+" "+(a.selected?c.selected:"")+'">'+' <button value="'+a.value+'">'+a.text+"</button>"+"</li>"},e=0;e<b.length;e++)if(b[e].group){var f=b[e].grpIdx;for(a+="<li><span>"+b[e].label+"</span><ul>";b[e]&&f===b[e].grpIdx;)a+=d(b[e]),e++;a+="</ul></li>"}else a+=d(b[e]);return"<ul hidden>"+a+"</ul>"},e.prototype.parse=function(){this.parsed=[];for(var a=0;a<this.select.childNodes.length;a++){var b=this.select.childNodes[a];"OPTGROUP"===b.nodeName.toUpperCase()?this.addGroup(b):"OPTION"===b.nodeName.toUpperCase()&&this.addOption(b,{group:!1,label:!1})}return this.parsed},e.prototype.addOption=function(a,b){this.parsed.push({text:a.text,value:a.value,selected:a.selected,group:b.group,label:b.label,grpIdx:b.group?this.grpIdx:-1,disabled:a.disabled}),a.selected&&(this.selected=a)},e.prototype.addGroup=function(a){this.grpIdx++;for(var b=0;b<a.children.length;b++)this.addOption(a.children[b],{group:!0,label:a.label})};var i=function(a,b){var c=[];for(var d in a)c.push(b+a[d]);return c};a.fn.esthetic=function(a){return this.each(function(){return new d(this,a)})},b.Esthetic=d}(jQuery,window);